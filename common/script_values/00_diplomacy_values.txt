leverage_threshold_to_invite = 200 	# Minimum leverage advantage from power bloc on country to be able to invite the country
decrease_autonomy_liberty_desire_to_add = 10 	# When you decrease autonomy of one of your subject, other direct subjects increase their liberty desire by this

annex_subject_max_liberty_desire_change = 25
annex_subject_intermediate_desire_change = 15
prestige_to_libery_desire_factor = 5 #converts ratio of prestige to liberty desire when subject over the expected
army_projection_to_libery_desire_factor = 10 #converts ratio of armed forces to liberty desire when subject over the expected
army_projection_comparison = {
	add = overlord.army_power_projection
	if = {
		limit = {
			army_power_projection > 0
		}
		divide = army_power_projection 
	}
}

overlords_overlord_army_projection_comparison = { 
	if = {
		limit = {
			exists = this.overlord.overlord
		}
		add = this.overlord.overlord.army_power_projection
	}
	if = {
		limit = {
			army_power_projection > 0
		}
		divide = army_power_projection 
	}
}

num_primary_cultures = {
	every_primary_culture = {
		add = 1
	}
}

annex_subject_base_liberty_desire_change = {
	scope:target_country ?= {
		add = prestige
	}
	round = yes
	min = 1
	max = annex_subject_max_liberty_desire_change
}

# root = pact
# root.first_country: first country in the pact. Overlord.
# root.second_country: second country in the pact. Subject.
# root = { liberty_desire < 50 }: compare trigger for current Liberty Desire value root.
# Must return a value which will be added to the current Liberty Desire in this pact.
liberty_desire_weekly_change = {
	add = {
		value = 0.1
		desc = "base_value"
	}	
	
	# Fervor and primary cultures
	if = {
		limit = {
			root.second_country = {
				NOT = {
					has_law_or_variant = law_type:law_subjecthood
				}
			}
			NOT = {
				root.second_country = {
					any_primary_culture = {
						is_primary_culture_of = root.first_country
					}
				}
			}
		}
		add = {
			desc = "LIBERTY_DESIRE_WEEKLY_CHANGE_CULTURAL_FERVOUR"
			value = root.second_country.country_fervor_primary_culture #grabs culture with highest fervor
			subtract = 25
			divide = 150
			min = -0.10
			max = 0.5
		}
	}
	else_if = { #if shares primary culture and no others
		limit = {
			root.second_country = {
				any_primary_culture = {
					percent = 1
					is_primary_culture_of = root.first_country  
				}
			}
		}
		add = { #extra for overlord culture's fervor. Note many overlord cultures do have high fervor because of literacy. 
			desc = "LIBERTY_DESIRE_SHARED_PRIMARY_CULTURE"
			add = -0.05 #base for overlord having same culture
			root.second_country = {
				every_primary_culture = {
					limit = {
						is_primary_culture_of = root.first_country
					}	
					add = culture_current_fervor
					subtract = 25
					divide = 150
					divide = root.second_country.num_primary_cultures
					max = 0
					min = 0.2
					multiply = -1
				}
			}
		}
	}
	else_if = { #if shares primary culture and mix of others
		limit = {
			root.second_country = {
				any_primary_culture = {
					is_primary_culture_of = root.first_country
				}
			}
		}
		add = {
			desc = "LIBERTY_DESIRE_SHARED_PRIMARY_CULTURE_MIX"
			add = { #extra for overlord culture's fervor. Note many overlord cultures do have high fervor because of literacy. 
				root.second_country = {
					every_primary_culture = {
						limit = {
							is_primary_culture_of = root.first_country
						}
						add = culture_current_fervor
						subtract = 25
						divide = 150
						divide = root.second_country.num_primary_cultures
						max = 0
						min = 0.25
						multiply = -1
					}
					if = {
						limit = {
							NOT = {
								has_law_or_variant = law_type:law_subjecthood
							}
						}
						every_primary_culture = {
							limit = {
								NOT = {
									is_primary_culture_of = root.first_country
								}
							}
							add = culture_current_fervor
							subtract = 25
							divide = 150
							divide = root.second_country.num_primary_cultures
							min = 0
							max = 0.50
						}
					}
				}
			}
		}
	}
	
	#relations
	add = {
		if = {
			limit = { "root.second_country.relations(root.first_country)" < relations_threshold:hostile }
			add = {
				add = 0.5
				desc = "LIBERTY_DESIRE_WEEKLY_CHANGE_RELATIONS_HOSTILE"
			}
		}
		else_if = {
			limit = { "root.second_country.relations(root.first_country)" < relations_threshold:cold }
			add = {
				add = 0.25
				desc = "LIBERTY_DESIRE_WEEKLY_CHANGE_RELATIONS_COLD"
			}
		}
		else_if = {
			limit = { "root.second_country.relations(root.first_country)" < relations_threshold:poor }
			add = {
				add = 0.10
				desc = "LIBERTY_DESIRE_WEEKLY_CHANGE_RELATIONS_POOR"
			}
		}
		else_if = {
			limit = { "root.second_country.relations(root.first_country)" < relations_threshold:cordial }
			add = {
				add = 0
				desc = "LIBERTY_DESIRE_WEEKLY_CHANGE_RELATIONS_NEUTRAL"
			}
		}
		else_if = {
			limit = { "root.second_country.relations(root.first_country)" >= relations_threshold:friendly }
			add = {
				add = -0.1
				desc = "LIBERTY_DESIRE_WEEKLY_CHANGE_RELATIONS_FRIENDLY"
			}
		}
		else_if = {
			limit = { "root.second_country.relations(root.first_country)" >= relations_threshold:amicable }
			add = {
				add = -0.05
				desc = "LIBERTY_DESIRE_WEEKLY_CHANGE_RELATIONS_AMICABLE"
			}
		}
		else_if = {
			limit = { "root.second_country.relations(root.first_country)" >= relations_threshold:cordial }
			add = {
				add = -0.025
				desc = "LIBERTY_DESIRE_WEEKLY_CHANGE_RELATIONS_CORDIAL"
			}
		}
	}

	#infamy
	add = {
		if = {
			limit = { root.first_country.infamy >= infamy_threshold:pariah }
			add = 2.0
		}
		else_if = {
			limit = { root.first_country.infamy >= infamy_threshold:notorious }
			add = 0.25
		}
		else_if = {
			limit = { root.first_country.infamy >= infamy_threshold:infamous }
			add = 0.1
		}

		desc = "concept_infamy"
	}

	#prestige
	if = {
		limit = { root.first_country.prestige < 1 }
		add = {
			add = 1
			desc = "LIBERTY_DESIRE_WEEKLY_CHANGE_NO_PRESTIGE_POSITIVE"
		}
	}
	else_if = {
		limit = { root.second_country.prestige < 1 }
		add = {
			add = -0.10
			desc = "LIBERTY_DESIRE_WEEKLY_CHANGE_NO_PRESTIGE_NEGATIVE"
		}
	}
	else_if = {
		limit = {
			OR = {
				is_diplomatic_action_type = protectorate
				is_diplomatic_action_type = personal_union
				is_diplomatic_action_type = confederal_state
			}
		}
		if = {
			limit = {
				root.first_country.prestige > {
					add = root.second_country.prestige
					# determines the multiple of prestige the overlord must have achieved in order for prestige advantage to have a negative impact on Liberty Desire rather than positive
					multiply = 1.5
				}
			}
			add = {
				add = root.first_country.prestige
				divide = root.second_country.prestige
				divide = 150
				min = 0.01
				max = 0.05
				multiply = -1
				desc = "LIBERTY_DESIRE_WEEKLY_CHANGE_PRESTIGE_DIFFERENCE_1_5_NEGATIVE"
			}
		}
		else = {
			add = {
				add = root.second_country.prestige
				multiply = 1.5
				divide = root.first_country.prestige
				divide = prestige_to_libery_desire_factor
				max = 0.5
				desc = "LIBERTY_DESIRE_WEEKLY_CHANGE_PRESTIGE_DIFFERENCE_1_5_POSITIVE"
			}
		}
	}
	else_if = {
		limit = {
			OR = {
				is_diplomatic_action_type = dominion
				is_diplomatic_action_type = satellite
				is_diplomatic_action_type = chartered_company
			}
		}
		if = {
			limit = {
				root.first_country.prestige > {
					add = root.second_country.prestige
					# determines the multiple of prestige the overlord must have achieved in order for prestige advantage to have a negative impact on Liberty Desire rather than positive
					multiply = 2.0
				}
			}
			add = {
				add = root.first_country.prestige
				divide = root.second_country.prestige
				divide = 200
				min = 0.01
				max = 0.05
				multiply = -1
				desc = "LIBERTY_DESIRE_WEEKLY_CHANGE_PRESTIGE_DIFFERENCE_2_0_NEGATIVE"
			}
		}
		else = {
			add = {
				add = root.second_country.prestige
				multiply = 2.0
				divide = root.first_country.prestige
				divide = prestige_to_libery_desire_factor
				max = 0.5
				desc = "LIBERTY_DESIRE_WEEKLY_CHANGE_PRESTIGE_DIFFERENCE_2_0_POSITIVE"
			}
		}
	}
	else_if = {
		limit = {
			OR = {
				is_diplomatic_action_type = puppet
				is_diplomatic_action_type = ﻿special_administrative_region
				is_diplomatic_action_type = ﻿semi_autonomous_colony
			}
		}
		if = {
			limit = {
				root.first_country.prestige > {
					add = root.second_country.prestige
					# determines the multiple of prestige the overlord must have achieved in order for prestige advantage to have a negative impact on Liberty Desire rather than positive
					multiply = 3
				}
			}
			add = {
				add = root.first_country.prestige
				divide = root.second_country.prestige
				divide = 300
				min = 0.01
				max = 0.10
				multiply = -1
				desc = "LIBERTY_DESIRE_WEEKLY_CHANGE_PRESTIGE_DIFFERENCE_3_0_NEGATIVE"
			}
		}
		else = {
			add = {
				add = root.second_country.prestige
				multiply = 3
				divide = root.first_country.prestige
				divide = prestige_to_libery_desire_factor
				max = 0.5
				desc = "LIBERTY_DESIRE_WEEKLY_CHANGE_PRESTIGE_DIFFERENCE_3_0_POSITIVE"
			}
		}
	}
	
	#army projection power
	if = {
		limit = { root.first_country.army_power_projection < 1 }
		add = {
			add = 1
			desc = "LIBERTY_DESIRE_WEEKLY_CHANGE_NO_ARMY_POWER_PROJECTION_POSITIVE"
		}
	}
	else_if = {
		limit = { root.second_country.army_power_projection < 1 }
		add = {
			add = -0.25 #get an army
			desc = "LIBERTY_DESIRE_WEEKLY_CHANGE_NO_ARMY_POWER_PROJECTION_NEGATIVE"
		}
	}
	else_if = {
		limit = {
			OR = {
				is_diplomatic_action_type = protectorate
				is_diplomatic_action_type = personal_union
				is_diplomatic_action_type = confederal_state
			}
		}
		if = {
			limit = {
				root.first_country.army_power_projection > {
					add = root.second_country.army_power_projection
					# determines the multiple of army_power_projection the overlord must have achieved in order for army_power_projection advantage to have a negative impact on Liberty Desire rather than positive
					multiply = 5
				}
			}
			add = {
				add = root.first_country.army_power_projection
				divide = root.second_country.army_power_projection
				divide = 100
				min = 0.01
				max = 0.10
				multiply = -1
				desc = "LIBERTY_DESIRE_WEEKLY_CHANGE_ARMY_POWER_PROJECTION_DIFFERENCE_5_0_NEGATIVE"
			}
		}
		else = {
			add = { # same army power as overlord, will give +0.5, steps up towards that after having more than a fifth of overlords army power
				add = root.second_country.army_power_projection
				multiply = 5
				divide = root.first_country.army_power_projection
				divide = army_projection_to_libery_desire_factor 
				max = 0.5
				desc = "LIBERTY_DESIRE_WEEKLY_CHANGE_ARMY_POWER_PROJECTION_DIFFERENCE_5_0_POSITIVE"
			}
		}
	}
	else_if = {
		limit = {
			OR = {
				is_diplomatic_action_type = dominion
				is_diplomatic_action_type = satellite
				is_diplomatic_action_type = chartered_company
			}
		}
		if = {
			limit = {
				root.first_country.army_power_projection > {
					add = root.second_country.army_power_projection
					multiply = 7.5
				}
			}
			add = {
				add = root.first_country.army_power_projection
				divide = root.second_country.army_power_projection
				divide = 175
				min = 0.01
				max = 0.10
				multiply = -1
				desc = "LIBERTY_DESIRE_WEEKLY_CHANGE_ARMY_POWER_PROJECTION_DIFFERENCE_7_5_NEGATIVE"
			}
		}
		else = {
			add = {
				add = root.second_country.army_power_projection
				multiply = 7.5
				divide = root.first_country.army_power_projection
				divide = army_projection_to_libery_desire_factor 
				max = 0.5
				desc = "LIBERTY_DESIRE_WEEKLY_CHANGE_ARMY_POWER_PROJECTION_DIFFERENCE_7_5_POSITIVE"
			}
		}
	}
	else_if = {
		limit = {
			OR = {
				is_diplomatic_action_type = puppet
				is_diplomatic_action_type = ﻿special_administrative_region
				is_diplomatic_action_type = ﻿semi_autonomous_colony
			}
		}
		if = {
			limit = {
				root.first_country.army_power_projection > {
					add = root.second_country.army_power_projection
					multiply = 10
				}
			}
			add = {
				add = root.first_country.army_power_projection
				divide = root.second_country.army_power_projection
				divide = 250
				min = 0.01
				max = 0.10
				multiply = -1
				desc = "LIBERTY_DESIRE_WEEKLY_CHANGE_ARMY_POWER_PROJECTION_DIFFERENCE_10_0_NEGATIVE"
			}
		}
		else = {
			add = {
				add = root.second_country.army_power_projection
				multiply = 10
				divide = root.first_country.army_power_projection
				divide = army_projection_to_libery_desire_factor 
				max = 0.5
				desc = "LIBERTY_DESIRE_WEEKLY_CHANGE_ARMY_POWER_PROJECTION_DIFFERENCE_10_0_POSITIVE"
			}
		}
	}

	# overlord's overlord has a huge army, scales up to a great power alliance
	if = {
		limit = {
			root.first_country = {
				is_subject = yes
			}
			root.first_country.overlord.army_power_projection > 0
			root.second_country.army_power_projection > 0
		}
		if = {
			limit = {
				root.first_country.overlord.army_power_projection > {
					add = root.second_country.army_power_projection
					multiply = 10
				}
			}
			add = {
				add = root.first_country.overlord.army_power_projection
				divide = root.second_country.army_power_projection
				divide = 250
				min = 0.01
				max = 0.10
				multiply = -1
				desc = "LIBERTY_DESIRE_OVERLORD_ARMY_POWER_PROJECTION_DIFFERENCE_10_0_NEGATIVE"
			}
		}
	}
	
	# alliances and defensive pacts of first country (partially counters support independence). Negative.
	first_country = {
		add = {
			if = { #alliances
				limit = {
					any_scope_treaty = {
						binds = root.first_country
						any_scope_article = {
							has_type = alliance
						}
					}
				}
				add = { 
					every_scope_ally = {
						limit = {
							country_rank >= rank_value:great_power
						}
						add = 0.10
					}
					every_scope_ally = {
						limit = {
							country_rank >= rank_value:major_power
						}
						add = 0.05
					}
					every_scope_ally = {
						limit = {
							country_rank >= rank_value:minor_power
						}
						add = 0.03
					}
				}
			}
			if = {  #defensive pacts, try more performative way
				limit = {
					root.first_country = {
						any_scope_treaty = {
							binds = root.first_country
							any_scope_article = {
								has_type = defensive_pact
							}
						}
					}
				}
				every_country = {
					limit = {
						NOT = {
							this = root.first_country
						}
						country_rank >= rank_value:great_power
						any_scope_treaty = {
							binds = root.first_country
							any_scope_article = {
								has_type = defensive_pact
							}
						}
					}
					add = 0.05
				}
				every_country = {
					limit = {
						NOT = {
							this = root.first_country
						}
						country_rank < rank_value:great_power
						country_rank >= rank_value:major_power
						any_scope_treaty = {
							binds = root.first_country
							any_scope_article = {
								has_type = defensive_pact
							}
						}
					}
					add = 0.03
				}
			}
			desc = "LIBERTY_DESIRE_NEGATIVE_OVERLORD_ALLIANCES"
			min = 0
			max = 0.25
			multiply = -1
		}
	}
	
	#lobbies
	second_country = {
		add = {
			ordered_interest_group = {
				limit = {
					is_member_of_lobby = lobby_type:lobby_pro_overlord
					is_in_government = yes
				}
				order_by = ig_clout
				subtract = ig_clout
				divide = 2
			}
			desc = "LIBERTY_DESIRE_WEEKLY_CHANGE_PRO_LOBBY_INTEREST_GROUP_IN_GOVERNMENT"
		}
		add = {
			ordered_interest_group = {
				limit = {
					is_member_of_lobby = lobby_type:lobby_pro_overlord
					is_in_government = no
				}
				order_by = ig_clout
				subtract = ig_clout
				divide = 4
			}
			desc = "LIBERTY_DESIRE_WEEKLY_CHANGE_PRO_LOBBY_INTEREST_GROUP_IN_OPPOSITION"
		}
		add = {
			ordered_interest_group = {
				limit = {
					is_member_of_lobby = lobby_type:lobby_anti_overlord
					is_in_government = yes
				}
				order_by = ig_clout
				add = ig_clout
				divide = 2
			}
			desc = "LIBERTY_DESIRE_WEEKLY_CHANGE_ANTI_LOBBY_INTEREST_GROUP_IN_GOVERNMENT"
		}
		add = {
			ordered_interest_group = {
				limit = {
					is_member_of_lobby = lobby_type:lobby_anti_overlord
					is_in_government = no
				}
				order_by = ig_clout
				add = ig_clout
				divide = 4
			}
			desc = "LIBERTY_DESIRE_WEEKLY_CHANGE_ANTI_LOBBY_INTEREST_GROUP_IN_OPPOSITION"
		}
	}
	
	#economic dependence
	if = {
		limit = { "root.second_country.economic_dependence(root.first_country)" > 0 }
		add = {
			value = 1
			subtract = "root.second_country.economic_dependence(root.first_country)"
			divide = 10
			desc = "LIBERTY_DESIRE_WEEKLY_CHANGE_ECONOMIC_DEPENDENCE"
		}
	}
	else = {
		add = {
			value = 1
			subtract = "root.second_country.economic_dependence(root.first_country)"
			divide = 3
			desc = "LIBERTY_DESIRE_WEEKLY_CHANGE_ECONOMIC_DEPENDENCE"
		}
	}

	#economic dependence if in different markets
	if = {
		limit = {
			root.second_country.market = root.first_country.market
			root.second_country.capital = { is_isolated_from_market = yes }
		}
		add = {
			value = 1
			desc = "LIBERTY_DESIRE_WEEKLY_CHANGE_ISOLATED_FROM_MARKET"
		}
	}
	else_if = {
		limit = {
			root.second_country.market = root.first_country.market
			root.first_country.supply_network_strength < 1
			root.second_country = { has_port = yes }
			NOT = { root.second_country = { is_adjacent_to_country = root.first_country }}
		}
		add = {
			value = 1
			subtract = root.first_country.supply_network_strength
			desc = "LIBERTY_DESIRE_WEEKLY_CHANGE_LOW_SUPPLY_NETWORK_STRENGTH"
		}
	}
	
	#power bloc sacred civics effect
	if = {
		limit = {
			root.first_country = {
				is_in_power_bloc = yes
				power_bloc = {
					OR = {
						has_principle = principle:principle_sacred_civics_2
						has_principle = principle:principle_sacred_civics_3
					}
				}
				religion = root.second_country.religion
			}
		}
		 add = {
		 	value = -0.1 desc =
		 	"LIBERTY_DESIRE_WEEKLY_CHANGE_SACRED_CIVICS"
		 }
	}

	#support independence boost. See pact for values. Scales by rank
	add = {
		value = root.second_country.liberty_desire_weekly_progress_from_support_independence
		desc = "LIBERTY_DESIRE_WEEKLY_CHANGE_FROM_SUPPORTING_INDEPENDENCE"
	}

	#liberty desire modifiers on subject
	add = {
		value = root.second_country.modifier:country_liberty_desire_add
		desc = "LIBERTY_DESIRE_WEEKLY_CHANGE_DESC_ADDITIONAL_ADDS"
	}

	#liberty desire modifiers on overlord
	add = {
		value = root.first_country.modifier:country_liberty_desire_of_subjects_add
		desc = "LIBERTY_SUBJECT_DESIRE_WEEKLY_CHANGE_DESC_ADDITIONAL_ADDS"
	}

	save_temporary_value_as = pre_scaling_value
	
	#apply scaling
	if = {
		limit = {
			scope:pre_scaling_value < 0
			second_country = {
				liberty_desire < 50
			}
		}
		multiply = {
			add = second_country.liberty_desire
			divide = 50
			desc = "LIBERTY_DESIRE_WEEKLY_CHANGE_SCALING_LOW"
		}
		max = -0.01
	}
	else_if = {
		limit = {
			scope:pre_scaling_value > 0
			second_country = {
				liberty_desire > 50
			}
		}
		multiply = {
			add = 100
			subtract = second_country.liberty_desire
			divide = 50
			desc = "LIBERTY_DESIRE_WEEKLY_CHANGE_SCALING_HIGH"
		}
		min = 0.01
	}

	save_temporary_value_as = pre_mult_modifiers_value

	multiply = {
		value = 1
		if = {
			limit = { scope:pre_mult_modifiers_value > 0 }
			add = root.second_country.modifier:country_liberty_desire_increase_mult
		}
		else_if = {
			limit = { scope:pre_mult_modifiers_value < 0 }
			add = root.second_country.modifier:country_liberty_desire_decrease_mult
		}
		min = 0
		desc = "LIBERTY_DESIRE_WEEKLY_CHANGE_DESC_ADDITIONAL_MULTS"
	}

	if = {
		limit = {
			root.second_country = {
				has_truce_with = root.first_country
				scope:pre_mult_modifiers_value > 0
			}
		}
		multiply = {
			value = 0.5
			desc = "LIBERTY_DESIRE_WEEKLY_CHANGE_TRUCE"
		}
	}

	second_country = {
		if = {
			limit = { 
				OR = { 
					is_a_colonial_subject_gov = yes 
					is_subject_type = subject_type_puppet
				}
			}
			add = {
				if = {
					limit = {  
						root.first_country = { has_law_or_variant = law_type:law_colonial_exploitation }
					}
					add = {
						add = 0.08
						desc = "LIBERTY_DESIRE_WEEKLY_CHANGE_ANTI_COLONIALISM"
					}
				}
				else_if = {
					limit = {  
						root.first_country = { has_law_or_variant = law_type:law_colonial_resettlement }
					}
					add = {
						add = 0.04
						desc = "LIBERTY_DESIRE_WEEKLY_CHANGE_ANTI_COLONIALISM"
					}
				}
				else = {
					add = {
						add = 0.02
						desc = "LIBERTY_DESIRE_WEEKLY_CHANGE_ANTI_COLONIALISM"
					}
				}
			}
		}
		add = {
			if = {
				limit = {  
					has_jingoistic_ruler = yes
					ruler ?= { culture = { culture_is_discriminated_in = root.second_country } }
				}
				add = {
					add = 0.1
					desc = "LIBERTY_DESIRE_WEEKLY_CHANGE_NON_NATIVE_RULER"
				}
			}
		}
		add = {
			if = {
				limit = {  
					has_jingoistic_ruler = yes
					ruler ?= { NOT = { has_jingoistic_ruler = yes } }
				}
				add = {
					add = 0.05
					desc = "LIBERTY_DESIRE_WEEKLY_CHANGE_DIFFERENT_RULER_IDEOLOGY"
				}
			}
		}
		add = {
			if = {
				limit = {  
					NOT = { is_a_colonial_subject_gov = yes }
					OR = { 
						AND = { 
							root.first_country = { has_law_or_variant = law_type:law_HOS_monarch }
							has_law_or_variant = law_type:law_HOS_monarch
						}
						AND = { 
							root.first_country = { has_law_or_variant = law_type:law_HOS_religious_leader }
							has_law_or_variant = law_type:law_HOS_religious_leader
						}
						AND = { 
							root.first_country = { has_law_or_variant = law_type:law_HOS_nationalist_leader }
							has_law_or_variant = law_type:law_HOS_nationalist_leader
						}
						AND = { 
							root.first_country = { has_law_or_variant = law_type:law_HOS_nationalist_leader }
							has_law_or_variant = law_type:law_HOS_communist_leader
						}
					}
				}
				add = {
					add = -0.20
					desc = "LIBERTY_DESIRE_WEEKLY_CHANGE_SIMILAR_GOV_TYPE"
				}
			}
		}
		add = {
			if = {
				limit = {  
					has_variable = SEZ_country_var
				}
				add = {
					add = -0.50
					desc = "LIBERTY_DESIRE_WEEKLY_CHANGE_SPECIAL_ECONOMIC_ZONE"
				}
			}
		}
	}
	
	first_country = {
		add = {
			if = {
				limit = {  
					ruler ?= { culture = { culture_is_discriminated_in = root.second_country } }
				}
				if = {
					limit = { has_law_or_variant = law_type:law_multicultural }
					add = {
						add = 0.02
						desc = "LIBERTY_DESIRE_WEEKLY_CHANGE_DIFFERENT_CULTURES"
					}
				}
				else_if = {
					limit = { has_law_or_variant = law_type:law_cultural_exclusion }
					add = {
						add = 0.04
						desc = "LIBERTY_DESIRE_WEEKLY_CHANGE_DIFFERENT_CULTURES"
					}
				}
				else_if = {
					limit = { has_law_or_variant = law_type:law_racial_segregation }
					add = {
						add = 0.06
						desc = "LIBERTY_DESIRE_WEEKLY_CHANGE_DIFFERENT_CULTURES"
					}
				}
				else_if = {
					limit = { has_law_or_variant = law_type:law_national_supremacy }
					add = {
						add = 0.08
						desc = "LIBERTY_DESIRE_WEEKLY_CHANGE_DIFFERENT_CULTURES"
					}
				}
				else = {
					add = {
						add = 0.10
						desc = "LIBERTY_DESIRE_WEEKLY_CHANGE_DIFFERENT_CULTURES"
					}
				}
			}
		}
		add = {
			if = {
				limit = {  
					religion = { NOT = { shares_trait_with_state_religion = root.second_country } }
				}
				if = {
					limit = { has_law_or_variant = law_type:law_freedom_of_conscience }
					add = {
						add = 0.02
						desc = "LIBERTY_DESIRE_WEEKLY_CHANGE_DIFFERENT_RELIGIONS"
					}
				}
				else_if = {
					limit = { has_law_or_variant = law_type:law_total_separation }
					add = {
						add = 0.04
						desc = "LIBERTY_DESIRE_WEEKLY_CHANGE_DIFFERENT_RELIGIONS"
					}
				}
				else = {
					add = {
						add = 0.05
						desc = "LIBERTY_DESIRE_WEEKLY_CHANGE_DIFFERENT_RELIGIONS"
					}
				}
			}
		}
	}
	
	if = {
		limit = { root.second_country.country_turmoil > 0.01 }
		add = {
			add = root.second_country.country_turmoil
			max = 0.50
			desc = "LIBERTY_DESIRE_WEEKLY_CHANGE_SUBJECT_TURMOIL"
		}
	}
	
	add = {
		add = root.second_country.legitimacy
		subtract = root.first_country.legitimacy
		divide = 1000
		desc = "LIBERTY_DESIRE_WEEKLY_CHANGE_DIFFERENT_LEGITIMACY"
	}
	
	if = {
		limit = { root.first_country = { has_diplomatic_pact = { who = root.second_country type = military_cooperation_agreement } } }
		add = {
			add = -0.05
			desc = "LIBERTY_DESIRE_WEEKLY_CHANGE_MILITARY_PRESENCE"
		}
	}
	
	if = {
		limit = { root.first_country = { has_diplomatic_pact = { who = root.second_country type = bankroll } } }
		add = {
			add = -0.05
			desc = "LIBERTY_DESIRE_WEEKLY_CHANGE_BANKROLL"
		}
	}
	
}

# root = pop
support_separatism_total_pop_support = {
	value = 10

	owner = {
		every_scope_diplomatic_pact = {
			limit = {
				is_diplomatic_action_type = support_separatism
				second_country = prev
				"diplomatic_pact_other_country(prev)" = {
					country_has_primary_culture = root.culture
				}
			}
			add = {
				value = 10
				add = this.first_country.country_rank
				subtract = this.second_country.country_rank
				multiply = {
					value = 1
					add = this.first_country.modifier:country_support_separatism_strength_mult
					subtract = this.second_country.modifier:country_support_separatism_resistance_mult
				}
			}
		}
	}

	max = 100 # ya never know
}

# root = movement
support_separatism_radicalism = {
	value = 0.05

	owner = {
		every_scope_diplomatic_pact = {
			limit = {
				is_diplomatic_action_type = support_separatism
				second_country = prev
				"diplomatic_pact_other_country(prev)" = {
					country_has_primary_culture = root.culture
				}
			}
			add = {
				value = 10
				add = this.first_country.country_rank
				subtract = this.second_country.country_rank
				multiply = {
					value = 1
					add = this.first_country.modifier:country_support_separatism_strength_mult
					subtract = this.second_country.modifier:country_support_separatism_resistance_mult
				}
				divide = 100
			}
		}
	}
	max = 0.5
}
