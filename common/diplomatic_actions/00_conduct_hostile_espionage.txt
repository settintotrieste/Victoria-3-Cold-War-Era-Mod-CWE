conduct_hostile_espionage = {
	requires_approval = no
	should_notify_third_parties = no
	show_effect_in_tooltip = yes

	unlocking_technologies = {
		tech_geopolitics_1
	}

	potential = {
	
		#THIS is not decentralized
		NOT = { is_country_type = decentralized }
		scope:target_country = { NOT = { is_country_type = decentralized } }
		
		#THIS has intelligence services
		has_law = law_type:law_offensive_espionage
		
		#THIS and Target are not revolutionary
		is_revolutionary = no is_secessionist = no
		scope:target_country = { is_revolutionary = no is_secessionist = no } 
		
		#THIS is not broke
		in_default = no
		
		#THIS is of a higher rank than the Target OR is a Great Power and above
		OR = { 
			scope:target_country = { country_rank < root.country_rank }
			country_rank >= rank_value:great_power
		}
		
		#THIS is sufficiently independent
		is_sufficiently_independent = yes
		
	}
	
	possible = {
		
		#THIS is interested in Target
		has_diplomatic_relevance = scope:target_country
		
		#THIS is not friendly with Target in anyway
		NOR = { 
			has_diplomatic_pact = { who = scope:target_country type = increase_relations }
			has_diplomatic_pact = { who = scope:target_country type = bankroll }
			has_diplomatic_pact = { who = scope:target_country type = alliance }
			has_diplomatic_pact = { who = scope:target_country type = defensive_pact } 
		}
		
		#Country wants to meddle in other's affairs
		OR = { 
		
			#Leader is aggressive
			AND = { 
				exists = ruler
				ruler = {
					OR = {
						has_ideology = ideology:ideology_autocratic
						has_ideology = ideology:ideology_power_hungry
						has_ideology = ideology:ideology_elitist
					}
				}
			}
			
			#Target is a rival of THIS
			has_diplomatic_pact = { who = scope:target_country type = rivalry is_initiator = no }
			
		}
		
		#THIS is not friendly with Target
		custom_tooltip = {
			text = DIPLO_ACTION_RELATIONS_NEUTRAL_OR_LESS
			scope:target_country.relations:root < relations_threshold:cordial
		}
		
	}
	
	pact = {	
		cost = 50
		is_two_sided_pact = no
		infamy_affects_maintenance = yes
		
		income_transfer = 0.01
		recipient_gets_income_transfer = yes
		income_transfer_based_on_recipient = yes
		
		### Validation requirements ###
		
		is_about_to_auto_break = {
            scope:target_country.relations:root >= relations_threshold:neutral
        }
		
		should_auto_break = {
			
			OR = { 
			
				#THIS is friendly with Target
				scope:target_country.relations:root >= relations_threshold:cordial
				
				#THIS is friendly with Target in anyway
				OR = { 
					has_diplomatic_pact = { who = scope:target_country type = increase_relations }
					has_diplomatic_pact = { who = scope:target_country type = bankroll }
					has_diplomatic_pact = { who = scope:target_country type = alliance }
					has_diplomatic_pact = { who = scope:target_country type = defensive_pact } 
				}
				
				#Country no longer wants to meddle in other's affairs
				NOR = { 
			
					#Leader is aggressive
					AND = { 
						exists = ruler
						ruler = {
							OR = {
								has_ideology = ideology:ideology_autocratic
								has_ideology = ideology:ideology_power_hungry
								has_ideology = ideology:ideology_elitist
							}
						}
					}
				
					#Target is a rival of THIS
					has_diplomatic_pact = { who = scope:target_country type = rivalry is_initiator = no }
				
				}
				
				#THIS is broke
				in_default = yes
			
			}
			
		}
		
		should_invalidate = {
		
			OR = { 
			
				#THIS no longer has intelligence services
				NOT = { has_law = law_type:law_offensive_espionage }
			
				#THIS has lost interest in Target
				NOT = { has_diplomatic_relevance = scope:target_country }
				
				#THIS is not of a higher rank than the Target OR is a Great Power and above
				NOR = {
					scope:target_country = { country_rank < root.country_rank }
					country_rank >= rank_value:great_power
				}
			
			}
			
		}
		
		### Effects added by Espionage JE ### 
		
		monthly_effect = {
			
			## Basic Effect - Increase radicals from discriminated ##
			scope:target_country = {
				random_scope_pop = {
					limit = { pop_is_discriminated = yes }
					culture = { save_scope_as = discrimated_culture_to_radicalise }
				}
				if = {
					limit = { exists = scope:discrimated_culture_to_radicalise }
					if = {
						limit = { institution_investment_level = { institution = institution_espionage value = 1 } }
						add_radicals = { 
							value = 0.008
							culture = scope:discrimated_culture_to_radicalise
						}
					}
					else_if = {
						limit = { institution_investment_level = { institution = institution_espionage value = 2 } }
						add_radicals = { 
							value = 0.006
							culture = scope:discrimated_culture_to_radicalise
						}
					}
					else_if = {
						limit = { institution_investment_level = { institution = institution_espionage value = 3 } }
						add_radicals = { 
							value = 0.004
							culture = scope:discrimated_culture_to_radicalise
						}
					}
					else_if = {
						limit = { institution_investment_level = { institution = institution_espionage value = 4 } }
						add_radicals = { 
							value = 0.002
							culture = scope:discrimated_culture_to_radicalise
						}
					}
					else_if = {
						limit = { institution_investment_level = { institution = institution_espionage value = 5 } }
						add_radicals = { 
							value = 0.001
							culture = scope:discrimated_culture_to_radicalise
						}
					}
					else = {
						add_radicals = { 
							value = 0.01
							culture = scope:discrimated_culture_to_radicalise
						}
					}
				}
			}
			
		}
		
	}
	
	ai = {
		max_influence_spending_fraction = 0.20
	
		propose_score = {
			value = 10
		}
		
		will_propose = {
			OR = { 
				has_attitude = {
					who = scope:target_country
					attitude <= antagonistic
				}
				has_diplomatic_pact = { who = scope:target_country type = rivalry }
				scope:target_country.relations:root < relations_threshold:poor
			}
		}
		
		will_break = {
			NOR = { 
				has_diplomatic_pact = { who = scope:target_country type = rivalry }
				scope:target_country.relations:root < relations_threshold:poor
				scope:target_country.infamy >= infamy_threshold:pariah
			}
			NOR = { 
				has_attitude = {
					who = scope:target_country
					attitude <= antagonistic
				}
				has_diplomatic_pact = { who = scope:target_country type = rivalry }
				scope:target_country.relations:root < relations_threshold:poor
			}
		}
		
	}
	
}

#Instigate Domestic Unrest [ONLY possible if country has an open media]
conduct_hostile_espionage_1 = {
	requires_approval = no
	should_notify_third_parties = no
	show_effect_in_tooltip = yes

	unlocking_technologies = {
		tech_geopolitics_1
	}

	potential = {
	
		has_journal_entry = je_secret_police_system
	
		#THIS has spies in TARGET
		has_diplomatic_pact = {
			who = scope:target_country
			type = conduct_hostile_espionage
			is_initiator = yes
		}
		
		#TARGET has an open media to exploit
		scope:target_country = { 
			country_has_an_open_media = yes 
		}
		
	}
	
	possible = {
		
		#Has enough action points
		custom_tooltip = {
			text = secret_police_action_25_points.tt
			has_variable = secret_police_action_points
			root.var:secret_police_action_points > 25
		}
		
		#Cooldown
		custom_tooltip = {
			text = secret_police_action_timer.tt
			NOT = { has_variable = secret_police_action_timer }
		}
		
	}
	
	accept_effect = {
		
		#Subtract action points
		custom_tooltip = {
			text = secret_police_action_subtract_25_points.tt
			if = {
				limit = { has_variable = secret_police_action_points }
				change_variable = { 
					name = secret_police_action_points
					add = -25
				}
			}
		}
		
		#Gain Loyalty
		custom_tooltip = {
			text = secret_police_gain_loyalty_5_points.tt
			change_variable = { 
				name = secret_police_loyalty
				add = 5
			}
			clamp_variable = {
				name = secret_police_loyalty
				max = 100
				min = 0
			}
		}
		
		#Instigate Domestic Unrest
		set_variable = espionage_attacker_var
		scope:target_country = {
			
			#Defence by the other side
			if = {
				limit = { institution_investment_level = { institution = institution_espionage value = 1 } }
				random_list = { 
					1 = { }
					1 = { trigger_event = { id = espionage_system.2 } }
				}
			}
			else_if = {
				limit = { institution_investment_level = { institution = institution_espionage value = 2 } }
				random_list = { 
					1 = { }
					2 = { trigger_event = { id = espionage_system.2 } }
				}
			}
			else_if = {
				limit = { institution_investment_level = { institution = institution_espionage value = 3 } }
				random_list = { 
					1 = { }
					3 = { trigger_event = { id = espionage_system.2 } }
				}
			}
			else_if = {
				limit = { institution_investment_level = { institution = institution_espionage value = 4 } }
				random_list = { 
					1 = { }
					4 = { trigger_event = { id = espionage_system.2 } }
				}
			}
			else_if = {
				limit = { institution_investment_level = { institution = institution_espionage value = 5 } }
				random_list = { 
					1 = { }
					5 = { trigger_event = { id = espionage_system.2 } }
				}
			}
			else = {
				trigger_event = { id = espionage_system.2 }
			}
			
		}
		
	}
	
	ai = {
	
		propose_score = {
			value = 10
		}
		
		will_propose = {
			OR = { 
				has_attitude = {
					who = scope:target_country
					attitude <= antagonistic
				}
				has_diplomatic_pact = { who = scope:target_country type = rivalry }
				scope:target_country.relations:root < relations_threshold:poor
			}
		}
		
	}
	
}

#Conduct Economic Sabotage
conduct_hostile_espionage_2 = {
	requires_approval = no
	should_notify_third_parties = no
	show_effect_in_tooltip = yes

	unlocking_technologies = {
		tech_geopolitics_1
	}

	potential = {
	
		has_journal_entry = je_secret_police_system
	
		#THIS has spies in TARGET
		has_diplomatic_pact = {
			who = scope:target_country
			type = conduct_hostile_espionage
			is_initiator = yes
		}
		
	}
	
	possible = {
		
		#Has enough action points
		custom_tooltip = {
			text = secret_police_action_25_points.tt
			has_variable = secret_police_action_points
			root.var:secret_police_action_points > 25
		}
		
		#Cooldown
		custom_tooltip = {
			text = secret_police_action_timer.tt
			NOT = { has_variable = secret_police_action_timer }
		}
		
	}
	
	accept_effect = {
		
		#Subtract action points
		custom_tooltip = {
			text = secret_police_action_subtract_25_points.tt
			if = {
				limit = { has_variable = secret_police_action_points }
				change_variable = { 
					name = secret_police_action_points
					add = -25
				}
			}
		}
		
		#Gain Loyalty
		custom_tooltip = {
			text = secret_police_gain_loyalty_5_points.tt
			change_variable = { 
				name = secret_police_loyalty
				add = 5
			}
			clamp_variable = {
				name = secret_police_loyalty
				max = 100
				min = 0
			}
		}
		
		#Conduct Economic Sabotage
		set_variable = espionage_attacker_var
		scope:target_country = {
		
			#Defence by the other side
			if = {
				limit = { institution_investment_level = { institution = institution_espionage value = 1 } }
				random_list = { 
					1 = { }
					1 = { trigger_event = { id = espionage_system.4 } }
				}
			}
			else_if = {
				limit = { institution_investment_level = { institution = institution_espionage value = 2 } }
				random_list = { 
					1 = { }
					2 = { trigger_event = { id = espionage_system.4 } }
				}
			}
			else_if = {
				limit = { institution_investment_level = { institution = institution_espionage value = 3 } }
				random_list = { 
					1 = { }
					3 = { trigger_event = { id = espionage_system.4 } }
				}
			}
			else_if = {
				limit = { institution_investment_level = { institution = institution_espionage value = 4 } }
				random_list = { 
					1 = { }
					4 = { trigger_event = { id = espionage_system.4 } }
				}
			}
			else_if = {
				limit = { institution_investment_level = { institution = institution_espionage value = 5 } }
				random_list = { 
					1 = { }
					5 = { trigger_event = { id = espionage_system.4 } }
				}
			}
			else = {
				trigger_event = { id = espionage_system.4 }
			}
			
		}
		
	}
	
	ai = {
	
		propose_score = {
			value = 10
		}
		
		will_propose = {
			OR = { 
				has_attitude = {
					who = scope:target_country
					attitude <= antagonistic
				}
				has_diplomatic_pact = { who = scope:target_country type = rivalry }
				scope:target_country.relations:root < relations_threshold:poor
			}
		}
		
	}
	
}

#Instigate Secessionist Movement
conduct_hostile_espionage_3 = {
	requires_approval = no
	should_notify_third_parties = no
	show_effect_in_tooltip = yes

	unlocking_technologies = {
		tech_geopolitics_1
	}

	potential = {
	
		has_journal_entry = je_secret_police_system
	
		#THIS has spies in TARGET
		has_diplomatic_pact = {
			who = scope:target_country
			type = conduct_hostile_espionage
			is_initiator = yes
		}
		
		#Has secessionist states
		scope:target_country = {
			num_incorporated_states > 1
			OR = {
				has_journal_entry = je_apartheid
				any_scope_state = {
					OR = { 
						NOT = { is_homeland_of_country_cultures = ROOT }
						is_incorporated = no
					}
				}
			}
		}
		
	}
	
	possible = {
		
		#Has enough action points
		custom_tooltip = {
			text = secret_police_action_25_points.tt
			has_variable = secret_police_action_points
			root.var:secret_police_action_points > 25
		}
		
		#Cooldown
		custom_tooltip = {
			text = secret_police_action_timer.tt
			NOT = { has_variable = secret_police_action_timer }
		}
		
	}
	
	accept_effect = {
		
		#Subtract action points
		custom_tooltip = {
			text = secret_police_action_subtract_25_points.tt
			if = {
				limit = { has_variable = secret_police_action_points }
				change_variable = { 
					name = secret_police_action_points
					add = -25
				}
			}
		}
		
		#Gain Loyalty
		custom_tooltip = {
			text = secret_police_gain_loyalty_5_points.tt
			change_variable = { 
				name = secret_police_loyalty
				add = 5
			}
			clamp_variable = {
				name = secret_police_loyalty
				max = 100
				min = 0
			}
		}
		
		#Instigate Secessionist Movement
		set_variable = espionage_attacker_var
		scope:target_country = {
		
			#Defence by the other side
			if = {
				limit = { institution_investment_level = { institution = institution_espionage value = 1 } }
				random_list = { 
					1 = { }
					1 = { trigger_event = { id = espionage_system.6 } }
				}
			}
			else_if = {
				limit = { institution_investment_level = { institution = institution_espionage value = 2 } }
				random_list = { 
					1 = { }
					2 = { trigger_event = { id = espionage_system.6 } }
				}
			}
			else_if = {
				limit = { institution_investment_level = { institution = institution_espionage value = 3 } }
				random_list = { 
					1 = { }
					3 = { trigger_event = { id = espionage_system.6 } }
				}
			}
			else_if = {
				limit = { institution_investment_level = { institution = institution_espionage value = 4 } }
				random_list = { 
					1 = { }
					4 = { trigger_event = { id = espionage_system.6 } }
				}
			}
			else_if = {
				limit = { institution_investment_level = { institution = institution_espionage value = 5 } }
				random_list = { 
					1 = { }
					5 = { trigger_event = { id = espionage_system.6 } }
				}
			}
			else = {
				trigger_event = { id = espionage_system.6 }
			}
			
		}
		
	}
	
	ai = {
	
		propose_score = {
			value = 10
		}
		
		will_propose = {
			OR = { 
				has_attitude = {
					who = scope:target_country
					attitude <= antagonistic
				}
				has_diplomatic_pact = { who = scope:target_country type = rivalry }
				scope:target_country.relations:root < relations_threshold:poor
			}
		}
		
	}
	
}

#Election Interference [ONLY possible if country has a ruling party & is having elections]
conduct_hostile_espionage_4 = {
	requires_approval = no
	should_notify_third_parties = no
	show_effect_in_tooltip = yes

	unlocking_technologies = {
		tech_geopolitics_1
	}

	potential = {
	
		has_journal_entry = je_secret_police_system
	
		#THIS has spies in TARGET
		has_diplomatic_pact = {
			who = scope:target_country
			type = conduct_hostile_espionage
			is_initiator = yes
		}
		
		#Has the appropriate law
		scope:target_country = { country_has_voting_franchise = yes }
		
	}
	
	possible = {
		
		#Has enough action points
		custom_tooltip = {
			text = secret_police_action_25_points.tt
			has_variable = secret_police_action_points
			root.var:secret_police_action_points > 25
		}
		
		#Cooldown
		custom_tooltip = {
			text = secret_police_action_timer.tt
			NOT = { has_variable = secret_police_action_timer }
		}
		
		#There is a party to sabotage
		scope:target_country = {
			any_interest_group = { 
				exists = leader 
				leader = { is_ruler = yes }
				has_party = yes
			}
			in_election_campaign = yes
		} 
		
	}
	
	accept_effect = {
		
		#Subtract action points
		custom_tooltip = {
			text = secret_police_action_subtract_25_points.tt
			if = {
				limit = { has_variable = secret_police_action_points }
				change_variable = { 
					name = secret_police_action_points
					add = -25
				}
			}
		}
		
		#Gain Loyalty
		custom_tooltip = {
			text = secret_police_gain_loyalty_5_points.tt
			change_variable = { 
				name = secret_police_loyalty
				add = 5
			}
			clamp_variable = {
				name = secret_police_loyalty
				max = 100
				min = 0
			}
		}
		
		#Election Interference
		set_variable = espionage_attacker_var
		scope:target_country = {
			
			#Defence by the other side
			if = {
				limit = { institution_investment_level = { institution = institution_espionage value = 1 } }
				random_list = { 
					1 = { }
					1 = { trigger_event = { id = espionage_system.8 } }
				}
			}
			else_if = {
				limit = { institution_investment_level = { institution = institution_espionage value = 2 } }
				random_list = { 
					1 = { }
					2 = { trigger_event = { id = espionage_system.8 } }
				}
			}
			else_if = {
				limit = { institution_investment_level = { institution = institution_espionage value = 3 } }
				random_list = { 
					1 = { }
					3 = { trigger_event = { id = espionage_system.8 } }
				}
			}
			else_if = {
				limit = { institution_investment_level = { institution = institution_espionage value = 4 } }
				random_list = { 
					1 = { }
					4 = { trigger_event = { id = espionage_system.8 } }
				}
			}
			else_if = {
				limit = { institution_investment_level = { institution = institution_espionage value = 5 } }
				random_list = { 
					1 = { }
					5 = { trigger_event = { id = espionage_system.8 } }
				}
			}
			else = {
				trigger_event = { id = espionage_system.8 }
			}
			
		}
		
	}
	
	ai = {
	
		propose_score = {
			value = 10
		}
		
		will_propose = {
			OR = { 
				has_attitude = {
					who = scope:target_country
					attitude <= antagonistic
				}
				has_diplomatic_pact = { who = scope:target_country type = rivalry }
				scope:target_country.relations:root < relations_threshold:poor
			}
		}
		
	}
	
}

#Terror attack
conduct_hostile_espionage_5 = {
	requires_approval = no
	should_notify_third_parties = no
	show_effect_in_tooltip = yes

	unlocking_technologies = {
		tech_geopolitics_1
	}

	potential = {
	
		has_journal_entry = je_secret_police_system
	
		#THIS has spies in TARGET
		has_diplomatic_pact = {
			who = scope:target_country
			type = conduct_hostile_espionage
			is_initiator = yes
		}
		
		#Has the appropriate law
		scope:target_country = { 
		
			#Borders are open for terrorists to enter
			NOT = { has_law = law_type:law_closed_borders }
		
			#There is at least some turmoil in TARGET
			any_scope_state = { turmoil >= 0.2 }
			
		}
		
	}
	
	possible = {
		
		#Has enough action points
		custom_tooltip = {
			text = secret_police_action_25_points.tt
			has_variable = secret_police_action_points
			root.var:secret_police_action_points > 25
		}
		
		#Cooldown
		custom_tooltip = {
			text = secret_police_action_timer.tt
			NOT = { has_variable = secret_police_action_timer }
		}
		
	}
	
	accept_effect = {
		
		#Subtract action points
		custom_tooltip = {
			text = secret_police_action_subtract_25_points.tt
			if = {
				limit = { has_variable = secret_police_action_points }
				change_variable = { 
					name = secret_police_action_points
					add = -25
				}
			}
		}
		
		#Gain Loyalty
		custom_tooltip = {
			text = secret_police_gain_loyalty_5_points.tt
			change_variable = { 
				name = secret_police_loyalty
				add = 5
			}
			clamp_variable = {
				name = secret_police_loyalty
				max = 100
				min = 0
			}
		}
		
		#Terror attack
		set_variable = espionage_attacker_var
		scope:target_country = {
			
			#Defence by the other side
			if = {
				limit = { institution_investment_level = { institution = institution_espionage value = 1 } }
				random_list = { 
					1 = { }
					1 = { trigger_event = { id = espionage_system.10 } }
				}
			}
			else_if = {
				limit = { institution_investment_level = { institution = institution_espionage value = 2 } }
				random_list = { 
					1 = { }
					2 = { trigger_event = { id = espionage_system.10 } }
				}
			}
			else_if = {
				limit = { institution_investment_level = { institution = institution_espionage value = 3 } }
				random_list = { 
					1 = { }
					3 = { trigger_event = { id = espionage_system.10 } }
				}
			}
			else_if = {
				limit = { institution_investment_level = { institution = institution_espionage value = 4 } }
				random_list = { 
					1 = { }
					4 = { trigger_event = { id = espionage_system.10 } }
				}
			}
			else_if = {
				limit = { institution_investment_level = { institution = institution_espionage value = 5 } }
				random_list = { 
					1 = { }
					5 = { trigger_event = { id = espionage_system.10 } }
				}
			}
			else = {
				trigger_event = { id = espionage_system.10 }
			}
			
		}
		
		#Gain infamy
		change_infamy = 5
		
	}
	
	ai = {
	
		propose_score = {
			value = 10
		}
		
		will_propose = {
			infamy < infamy_threshold:infamous
			OR = { 
				has_attitude = {
					who = scope:target_country
					attitude <= antagonistic
				}
				has_diplomatic_pact = { who = scope:target_country type = rivalry }
				scope:target_country.relations:root < relations_threshold:poor
			}
		}
		
	}
	
}