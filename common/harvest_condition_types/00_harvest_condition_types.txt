# Negative
drought = {
	trigger = {
		is_vulnerable_to_droughts = yes
		is_in_winter = no
	}

	incompatible_with = flood
	incompatible_with = frost
	incompatible_with = hailstorm
	incompatible_with = torrential_rains
	incompatible_with = moderate_rainfall
	incompatible_with = tsunami
	incompatible_with = earthquake
	# Incompatible with Drought: flood, frost, hailstorm, heatwave, torrential rains, pollinator surge, optimal sunlight
	# Replaces heatwave, optimal sunlight, pollinator surge

	range = {
		integer_range = {
			min = 1
			max = 2
		}
	}

	duration = {
		fixed_range = {
			min = 36
			max = 104
		}
	}

	modifier = {
		#Throughput
		building_group_bg_agriculture_throughput_add = -0.05
		building_group_bg_plantations_throughput_add = -0.05
		building_group_bg_ranching_throughput_add = -0.05

		#Infrastructure
		building_group_bg_agriculture_infrastructure_usage_mult = 0.1
		building_group_bg_plantations_infrastructure_usage_mult = 0.1
		building_group_bg_ranching_infrastructure_usage_mult = 0.1

		#Subsistence
		state_peasants_consumption_multiplier_add = 0.025
	}

	intensity = {
		fixed_range = {
			min = 2
			max = 6
		}
	}

	chance = {
		value = 0.0025
		if = {
			limit = {
				has_harvest_condition = optimal_sunlight
			}
			multiply = 1.2
		}
		if = {
			limit = {
				has_harvest_condition = heatwave
			}
			multiply = 1.5
		}
	}

	color = { 222 62 37 }
	icon = "gfx/interface/icons/harvest_condition_icons/drought.dds"
	map_texture = "gfx/map/map_painting/harvest_conditions_map_patterns/harvest_conditions_bad.dds"
	graphics = drought
}

flood = {
	trigger = {
		is_vulnerable_to_floods = yes
		is_in_winter = no
	}

	incompatible_with = drought
	incompatible_with = wildfire
	incompatible_with = frost
	incompatible_with = tsunami
	incompatible_with = earthquake
	# Incompatible with flood: frost, wildfire, torrential rains, pollinator surge, optimal sunlight, moderate rainfall, drought
	# Replaces torrential rains, pollinator surge, optimal sunlight, moderate rainfall

	range = {
		integer_range = {
			min = 1
			max = 2
		}
	}

	duration = {
		fixed_range = {
			min = 5
			max = 10
		}
	}

	modifier = {
		#Infrastructure
		state_infrastructure_mult = -0.05

		#MAPI
		state_market_access_price_impact = -0.05

		#Throughput
		building_group_bg_agriculture_throughput_add = -0.05
		building_group_bg_plantations_throughput_add = -0.05
		building_group_bg_ranching_throughput_add = -0.05
		building_group_bg_extraction_throughput_add = -0.05

		#Subsistence
		state_peasants_consumption_multiplier_add = 0.025
	}

	intensity = {
		fixed_range = {
			min = 3
			max = 6
		}
	}

	chance = {
		value = 0.0025
		if = {
			limit = {
				OR = {
					has_harvest_condition = moderate_rainfall
					has_harvest_condition = heatwave
				}
			}
			multiply = 1.2
		}
		if = {
			limit = {
				has_harvest_condition = hailstorm
			}
			multiply = 1.1
		}
		if = {
			limit = {
				has_harvest_condition = torrential_rains
			}
			multiply = 1.5
		}
	}

	color = { 85 65 8 }
	icon = "gfx/interface/icons/harvest_condition_icons/flood.dds"
	map_texture = "gfx/map/map_painting/harvest_conditions_map_patterns/harvest_conditions_bad.dds"
	graphics = flood
}

frost = {
	trigger = {
		is_vulnerable_to_frosts = yes
		OR = { 
			month = 11
			month = 12
			month = 1
			month = 2
		}
	}

	incompatible_with = drought
	incompatible_with = wildfire
	incompatible_with = heatwave
	incompatible_with = optimal_sunlight
	incompatible_with = moderate_rainfall
	incompatible_with = torrential_rains
	incompatible_with = flood
	incompatible_with = tsunami
	incompatible_with = earthquake
	# Incompatible with frost: drought, flood, wildfire, locust swarm, heatwave, torrential rains, pollinator surge, optimal sunlight, moderate rainfall
	# Replaces locust swarm, pollinator surge, optimal sunlight, moderate rainfall

	range = {
		integer_range = {
			min = 1
			max = 1
		}
	}

	duration = {
		fixed_range = {
			min = 5
			max = 10
		}
	}

	modifier = {
		#Throughput
		building_group_bg_agriculture_throughput_add = -0.05
		building_group_bg_plantations_throughput_add = -0.05

		#Subsistence
		state_peasants_consumption_multiplier_add = 0.03
	}

	intensity = {
		fixed_range = {
			min = 2
			max = 4
		}
		if = {
			limit = {
				has_global_variable = krakatoa_temperature_drop
			}
			add = global_var:krakatoa_temperature_drop
		}
	}

	chance = {
		value = 0.75
		if = {
			limit = {
				has_harvest_condition = hailstorm
			}
			multiply = 1.5
		}
		if = {
			limit = {
				has_global_variable = krakatoa_temperature_drop
			}
			multiply = {
				value = krakatoa_temperature_drop_harvest_condition_chance_base_mult
				add = global_var:krakatoa_temperature_drop
			}
		}
	}

	color = { 47 127 185 }
	icon = "gfx/interface/icons/harvest_condition_icons/frost.dds"
	map_texture = "gfx/map/map_painting/harvest_conditions_map_patterns/harvest_conditions_bad.dds"
	graphics = frost
}

wildfire = {
	trigger = {
		is_vulnerable_to_wildfires = yes
		is_in_winter = no
	}

	incompatible_with = flood
	incompatible_with = frost
	incompatible_with = hailstorm
	incompatible_with = torrential_rains
	incompatible_with = moderate_rainfall
	incompatible_with = tsunami
	incompatible_with = earthquake
	# Incompatible with Wildfire: flood, frost, hail, locusts, heatwave, torrential rains, pollinators, optimal sunlight, moderate rainfall
	# Replaces locusts, heatwave, pollinators, optimal sunlight, moderate rainfall

	range = {
		integer_range = {
			min = 1
			max = 2
		}
	}

	duration = {
		fixed_range = {
			min = 5
			max = 10
		}
	}

	modifier = {
		# Throughput
		building_group_bg_agriculture_throughput_add = -0.05
		building_group_bg_plantations_throughput_add = -0.05
		building_group_bg_ranching_throughput_add = -0.05
		building_group_bg_extraction_throughput_add = -0.05

		# Infra - Building
		building_group_bg_agriculture_infrastructure_usage_mult = 0.1
		building_group_bg_plantations_infrastructure_usage_mult = 0.1
		building_group_bg_ranching_infrastructure_usage_mult = 0.1

		# Infra - State
		state_infrastructure_mult = -0.05

		#Subsistence
		state_peasants_consumption_multiplier_add = 0.03
	}

	intensity = {
		fixed_range = {
			min = 4
			max = 8
		}
	}

	chance = {
		value = 0.0008
		if = {
			limit = {
				has_harvest_condition = optimal_sunlight
			}
			multiply = 1.2
		}
		if = {
			limit = {
				has_harvest_condition = heatwave
			}
			multiply = 1.3
		}
		if = {
			limit = {
				has_harvest_condition = drought
			}
			multiply = 1.4
		}
	}

	color = { 152 42 46 }
	icon = "gfx/interface/icons/harvest_condition_icons/wildfire.dds"
	map_texture = "gfx/map/map_painting/harvest_conditions_map_patterns/harvest_conditions_bad.dds"
	graphics = wildfire
}

hailstorm = {
	trigger = {
		is_vulnerable_to_hailstorm = yes
		OR = { 
			month = 11
			month = 12
			month = 1
			month = 2
		}
	}

	incompatible_with = drought
	incompatible_with = wildfire
	incompatible_with = heatwave
	incompatible_with = optimal_sunlight
	incompatible_with = tsunami
	incompatible_with = earthquake
	# Incompatible with hailstorm: drought, wildfire, locusts, heatwave, pollinators, optimal sunlight, moderate rainfall
	# Replaces locusts, pollinators, moderate rainfall

	range = {
		integer_range = {
			min = 1
			max = 1
		}
	}

	duration = {
		fixed_range = {
			min = 5
			max = 10
		}
	}

	modifier = {
		# Throughput
		building_group_bg_agriculture_throughput_add = -0.05
		building_group_bg_plantations_throughput_add = -0.05
		building_group_bg_ranching_throughput_add = -0.05
		building_group_bg_logging_throughput_add = -0.05
	}

	intensity = {
		fixed_range = {
			min = 2
			max = 4
		}
		if = {
			limit = {
				has_global_variable = krakatoa_temperature_drop
			}
			add = global_var:krakatoa_temperature_drop
		}
	}

	chance = {
		value = 0.0025
		if = {
			limit = {
				OR = {
					has_harvest_condition = frost
					has_harvest_condition = torrential_rains
				}
			}
			multiply = 1.3
		}
		if = {
			limit = {
				has_global_variable = krakatoa_temperature_drop
			}
			multiply = {
				value = krakatoa_temperature_drop_harvest_condition_chance_base_mult
				add = global_var:krakatoa_temperature_drop
			}
		}
	}

	color = { 70 234 255 }
	icon = "gfx/interface/icons/harvest_condition_icons/hailstorm.dds"
	map_texture = "gfx/map/map_painting/harvest_conditions_map_patterns/harvest_conditions_bad.dds"
	graphics = hail
}

locust_swarm = {
	trigger = {
		is_vulnerable_to_locust_swarms = yes
		is_in_winter = no
	}

	incompatible_with = frost
	incompatible_with = wildfire
	incompatible_with = extreme_winds
	incompatible_with = hailstorm
	incompatible_with = torrential_rains
	# Incompatible with Locust Swarm: pollinator surge
	# Replaces pollinator surge

	range = {
		integer_range = {
			min = 1
			max = 2
		}
	}

	duration = {
		fixed_range = {
			min = 5
			max = 10
		}
	}

	modifier = {
		# Throughput
		building_group_bg_agriculture_throughput_add = -0.05
		building_group_bg_plantations_throughput_add = -0.05
		building_group_bg_ranching_throughput_add = -0.05

		#Subsistence
		state_peasants_consumption_multiplier_add = 0.03
	}

	intensity = {
		fixed_range = {
			min = 3
			max = 5
		}
	}

	chance = {
		value = 0.0015
	}

	color = { 184 121 0 }
	icon = "gfx/interface/icons/harvest_condition_icons/locust_swarm.dds"
	map_texture = "gfx/map/map_painting/harvest_conditions_map_patterns/harvest_conditions_bad.dds"
	graphics = locust_swarm
}

heatwave = {
	trigger = {
		is_vulnerable_to_heatwaves = yes
		is_in_winter = no
	}

	incompatible_with = hailstorm
	incompatible_with = frost
	incompatible_with = drought
	incompatible_with = wildfire
	# Incompatible with Heatwave: frost, hail, pollinators, optimal sunlight
	# Replaces pollinators, optimal sunlight

	range = {
		integer_range = {
			min = 1
			max = 2
		}
	}

	duration = {
		fixed_range = {
			min = 5
			max = 20
		}
	}

	modifier = {
		# Throughput
		building_group_bg_agriculture_throughput_add = -0.05
		building_group_bg_plantations_throughput_add = -0.05
		building_group_bg_ranching_throughput_add = -0.05
		building_group_bg_rubber_throughput_add = -0.05
		building_group_bg_logging_throughput_add = -0.05
	}

	intensity = {
		fixed_range = {
			min = 2
			max = 4
		}
	}

	chance = {
		value = 0.0025
		if = {
			limit = {
				has_harvest_condition = optimal_sunlight
			}
			multiply = 1.4
		}
	}

	color = { 166 67 0 }
	icon = "gfx/interface/icons/harvest_condition_icons/heatwave.dds"
	map_texture = "gfx/map/map_painting/harvest_conditions_map_patterns/harvest_conditions_bad.dds"
	graphics = heatwave
}

disease_outbreak = {
	trigger = {
		is_vulnerable_to_disease_outbreak = yes
	}

	# Incompatible with Disease Outbreak: pollinators
	# Replaces pollinators

	range = {
		integer_range = {
			min = 1
			max = 1
		}
	}

	duration = {
		fixed_range = {
			min = 36
			max = 96
		}
	}

	modifier = {
		# Throughput
		building_urban_center_throughput_add = -0.05
		building_group_bg_agriculture_throughput_add = -0.05
		building_group_bg_plantations_throughput_add = -0.05
		building_group_bg_ranching_throughput_add = -0.05

		#Subsistence
		state_peasants_consumption_multiplier_add = 0.03
	}

	intensity = {
		fixed_range = {
			min = 3
			max = 7
		}
		if = {
			limit = {
				has_global_variable = krakatoa_temperature_drop
			}
			add = global_var:krakatoa_temperature_drop
		}
		if = {
			limit = {
				has_global_variable = hungry_forties_var
			}
			add = 2
			if = {
				limit = {
					is_homeland = cu:irish
				}
				add = 2 # To make things quite terrible in Ireland
			}
		}
	}

	chance = {
		value = 0.0008
		if = { # pre-Hungry Forties
			limit = {
				game_date > 1840.1.1
				game_date < 1850.1.1
				any_scope_state = {
					is_in_geographic_region = geographic_region_europe
				}
				NOT = { has_global_variable = hungry_forties_var }
			}
			multiply = 25
		}
		if = { # The Hungry Forties - will never stack with previous
			limit = {
				has_global_variable = hungry_forties_var
				any_scope_state = {
					is_in_geographic_region = geographic_region_europe
				}
				NOT = {
					has_variable = had_disease_outbreak_recently # To prevent excessive spamming
				}
			}
			multiply = 100
		}
		if = {
			limit = {
				has_global_variable = krakatoa_temperature_drop
			}
			multiply = {
				value = krakatoa_temperature_drop_harvest_condition_chance_base_mult
				add = {
					value = global_var:krakatoa_temperature_drop
					multiply = 5
					if = {
						limit = {
							OR = {
								is_in_geographic_region = geographic_region_europe
								is_in_geographic_region = geographic_region_north_america
								is_in_geographic_region = geographic_region_central_asia
								is_in_geographic_region = geographic_region_east_asia
							}
						}
						add = krakatoa_temperature_drop_disease_outbreak_chance_mult
					}
				}
			}
		}
	}

	color = { 78 70 57 }
	icon = "gfx/interface/icons/harvest_condition_icons/disease_outbreak.dds"
	map_texture = "gfx/map/map_painting/harvest_conditions_map_patterns/harvest_conditions_bad.dds"
	graphics = disease_outbreak
}

extreme_winds = {
	trigger = {
		is_vulnerable_to_extreme_winds = yes
	}

	# Incompatible with Extreme Winds: pollinators, locusts
	# Replaces pollinators, locusts

	range = {
		integer_range = {
			min = 1
			max = 2
		}
	}

	duration = {
		fixed_range = {
			min = 36
			max = 104
		}
	}

	modifier = {
		# Throughput
		building_group_bg_agriculture_throughput_add = -0.05
		building_group_bg_plantations_throughput_add = -0.05
	}

	intensity = {
		fixed_range = {
			min = 2
			max = 5
		}
	}

	chance = {
		value = 0.0025
	}

	color = { 79 204 169 }
	icon = "gfx/interface/icons/harvest_condition_icons/extreme_winds.dds"
	map_texture = "gfx/map/map_painting/harvest_conditions_map_patterns/harvest_conditions_bad.dds"
	graphics = extreme_winds
}

torrential_rains = {
	trigger = {
		is_vulnerable_to_torrential_rains = yes
		is_in_winter = no
	}

	incompatible_with = drought
	incompatible_with = wildfire
	incompatible_with = flood
	incompatible_with = frost
	# Incompatible with Torrential Rains: drought, frost, wildfire, locusts, pollinators, optimal sunlight, moderate rainfall
	# Replaces locusts, pollinators, optimal sunlight, moderate rainfall

	range = {
		integer_range = {
			min = 1
			max = 2
		}
	}

	duration = {
		fixed_range = {
			min = 5
			max = 10
		}
	}

	modifier = {
		# Throughput
		building_group_bg_agriculture_throughput_add = -0.05
		building_group_bg_plantations_throughput_add = -0.05
		building_group_bg_ranching_throughput_add = -0.03
		building_group_bg_extraction_throughput_add = -0.03

		#Infra
		state_infrastructure_mult = -0.1
	}

	intensity = {
		fixed_range = {
			min = 2
			max = 5
		}
		if = {
			limit = {
				has_global_variable = krakatoa_temperature_drop
			}
			add = global_var:krakatoa_temperature_drop
		}
	}

	chance = {
		value = 0.003
		if = {
			limit = {
				OR = {
					has_harvest_condition = heatwave
					has_harvest_condition = moderate_rainfall
				}
			}
			multiply = 1.3
		}
		if = {
			limit = {
				has_global_variable = krakatoa_temperature_drop
			}
			multiply = {
				value = krakatoa_temperature_drop_harvest_condition_chance_base_mult
				add = global_var:krakatoa_temperature_drop
			}
		}
	}


	color = { 34 75 120 } # darker slate gray
	icon = "gfx/interface/icons/harvest_condition_icons/torrential_rains.dds"
	map_texture = "gfx/map/map_painting/harvest_conditions_map_patterns/harvest_conditions_bad.dds"
	graphics = torrential_rains
}

# Positive

pollinator_surge = {
	trigger = {
		has_potential_for_pollinator_surge = yes
		is_in_winter = no
	}

	incompatible_with = drought
	incompatible_with = flood
	incompatible_with = frost
	incompatible_with = wildfire
	incompatible_with = hailstorm
	incompatible_with = locust_swarm
	incompatible_with = heatwave
	incompatible_with = disease_outbreak
	incompatible_with = extreme_winds
	incompatible_with = torrential_rains

	range = {
		integer_range = {
			min = 1
			max = 1
		}
	}

	duration = {
		fixed_range = {
			min = 5
			max = 15
		}
	}

	modifier = {
		#Throughput
		building_group_bg_plantations_throughput_add = 0.1

		#Output
		goods_output_fruit_mult = 0.05
	}

	intensity = {
		fixed_range = {
			min = 1
			max = 4
		}
	}

	chance = {
		value = 0.0025
	}

	color = { 90 140 0 }
	icon = "gfx/interface/icons/harvest_condition_icons/pollinator_surge.dds"
	map_texture = "gfx/map/map_painting/harvest_conditions_map_patterns/harvest_conditions_good.dds"
}

optimal_sunlight = {
	trigger = {
		has_potential_for_optimal_sunlight = yes
		is_in_winter = no
	}

	incompatible_with = drought
	incompatible_with = flood
	incompatible_with = frost
	incompatible_with = wildfire
	incompatible_with = hailstorm
	incompatible_with = heatwave
	incompatible_with = torrential_rains
	#Incompatible with Optimal Sunlight: frost, hailstorm

	range = {
		integer_range = {
			min = 1
			max = 2
		}
	}

	duration = {
		fixed_range = {
			min = 36
			max = 104
		}
	}

	modifier = {
		# Throughput
		building_group_bg_agriculture_throughput_add = 0.05
		building_group_bg_plantations_throughput_add = 0.05

		#Subsistence
		state_peasants_consumption_multiplier_add = -0.01
	}

	intensity = {
		fixed_range = {
			min = 2
			max = 5
		}
	}

	chance = {
		value = 0.003
	}

	color = { 125 255 62 }
	icon = "gfx/interface/icons/harvest_condition_icons/optimal_sunlight.dds"
	map_texture = "gfx/map/map_painting/harvest_conditions_map_patterns/harvest_conditions_good.dds"
}

moderate_rainfall = {
	trigger = {
		has_potential_for_moderate_rainfall = yes
		is_in_winter = no
	}

	incompatible_with = drought
	incompatible_with = flood
	incompatible_with = frost
	incompatible_with = wildfire
	incompatible_with = hailstorm
	incompatible_with = torrential_rains
	#Incompatible with Moderate Rainfall: drought, frost, wildfire

	range = {
		integer_range = {
			min = 1
			max = 2
		}
	}

	duration = {
		fixed_range = {
			min = 5
			max = 10
		}
	}

	modifier = {
		# Throughput
		building_group_bg_agriculture_throughput_add = 0.05
		building_group_bg_plantations_throughput_add = 0.05
		building_group_bg_ranching_throughput_add = 0.03

		#Subsistence
		state_peasants_consumption_multiplier_add = -0.01
	}

	intensity = {
		fixed_range = {
			min = 2
			max = 4
		}
	}

	chance = {
		value = 0.003
	}

	color = { 65 100 250 }
	icon = "gfx/interface/icons/harvest_condition_icons/moderate_rainfall.dds"
	map_texture = "gfx/map/map_painting/harvest_conditions_map_patterns/harvest_conditions_good.dds"
}

# Natural Disasters
tsunami = {
	trigger = {
		always = no # Currently only triggered through je_krakatoa
	}

	range = {
		integer_range = {
			min = 1
			max = 5
		}
	}

	duration = {
		fixed_range = {
			min = 5
			max = 10
		}
	}

	modifier = {
		#Infrastructure
		state_infrastructure_mult = -0.05

		#MAPI
		state_market_access_price_impact = -0.05

		#Throughput
		building_group_bg_agriculture_throughput_add = -0.05
		building_group_bg_plantations_throughput_add = -0.05
		building_group_bg_ranching_throughput_add = -0.05
		building_group_bg_extraction_throughput_add = -0.05

		#Subsistence
		state_peasants_consumption_multiplier_add = 0.05

		#Mortality
		state_mortality_mult = 0.05
	}

	intensity = {
		if = {
			limit = {
				OR = {
					region = sr:region_indonesia
					region = sr:region_indochina
					region = sr:region_oceania
				}
			}
			fixed_range = {
				min = 3
				max = 6
			}
		}
		else = {
			fixed_range = {
				min = 1
				max = 3
			}
		}
	}

	chance = {
		value = 0
	}

	color = { 23 106 173 }
	icon = "gfx/interface/icons/harvest_condition_icons/flood.dds"
	map_texture = "gfx/map/map_painting/harvest_conditions_map_patterns/harvest_conditions_bad.dds"
	graphics = flood
}

earthquake = {
	trigger = {
		is_vulnerable_to_earthquakes = yes
	}

	incompatible_with = tsunami

	range = {
		integer_range = {
			min = 1
			max = 2
		}
	}

	duration = {
		fixed_range = {
			min = 5
			max = 10
		}
	}

	modifier = {
		#Infrastructure
		state_infrastructure_mult = -0.05

		#MAPI
		state_market_access_price_impact = -0.05

		#Throughput
		building_urban_center_throughput_add = -0.05
		building_group_bg_agriculture_throughput_add = -0.05
		building_group_bg_plantations_throughput_add = -0.05
		building_group_bg_ranching_throughput_add = -0.05
		building_group_bg_extraction_throughput_add = -0.05

		#Subsistence
		state_peasants_consumption_multiplier_add = 0.025

		#Mortality
		state_mortality_mult = 0.05
	}

	intensity = {
		if = {
			limit = {
				is_in_geographic_region = geographic_region_ring_of_fire
			}
			fixed_range = {
				min = 2
				max = 6
			}
		}
		else_if = {
			limit = {
				is_in_geographic_region = geographic_region_alpide_belt
			}
			fixed_range = {
				min = 2
				max = 4
			}
		}
		else_if = {
			limit = {
				is_in_geographic_region = geographic_region_great_rift_valley
			}
			fixed_range = {
				min = 1
				max = 3
			}
		}
		else = {
			fixed_range = {
				min = 1
				max = 2
			}
		}
	}

	chance = {
		value = 0.0015
		if = {
			limit = {
				is_in_geographic_region = geographic_region_great_rift_valley
			}
			multiply = 1.1
		}
		if = {
			limit = {
				is_in_geographic_region = geographic_region_alpide_belt
			}
			multiply = 1.4
		}
		if = {
			limit = {
				is_in_geographic_region = geographic_region_ring_of_fire
			}
			multiply = 1.5
		}
		if = { # To make the Manila Cathedral content more visible
			limit = {
				s:STATE_LUZON ?= this
			}
			multiply = 1.5
		}
	}

	color = { 166 67 0 }
	icon = "gfx/interface/icons/harvest_condition_icons/earthquake.dds"
	map_texture = "gfx/map/map_painting/harvest_conditions_map_patterns/harvest_conditions_bad.dds"
	graphics = earthquake
}
